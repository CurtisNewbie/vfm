# Thumbnail Generation

All thumbnails are generated by [mini-fstore](https://github.com/CurtisNewbie/mini-fstore). Whenever a file is uploaded to `mini-fstore`, a file record is also created in `vfm`, `vfm` checks whether it's potentially an image/video (by the file name). If so, it sends a MQ message to `mini-fstore` (via RabbitMQ) to trigger the async thumbnail generation. The thumbnail is generated and saved in `mini-fstore` by itself, then a MQ message replied by `mini-fstore` tells what the file_id (in mini-fstore) of the thumbnail is.

To compensate the thumbnail generation for historical records, uses following curl command to trigger the compensation process.

```sh
curl -X POST "http://localhost:8086/compensate/image/compression"
```